# Инструкция по работе с приложением

## Сборка и старт приложения

1. Необходимо собрать и запустить docker-контейнеры

```shell
$ docker compose build
$ docker compose up -d
```

2. Запуск воркера, который обрабатывает задачи из очереди

```shell
$ docker exec app bash
$ php artisan worker:run
```

## Принцип работы API

Принцип работы API заключается в том, что пользователь отправляет запросы и получает идентификатор отправленного запроса.  
Запрос отправляется в очередь на обработку.  
Пользователь делает запрос на получение статуса обработки запроса.  
Если запрос обработан успешно, в теле ответа будет передан результат выполнения запроса.

####Пользовательские запросы:

1. Запрос на создание пользователя

```http request
POST http://application.local/api/v1/user
Content-Type: application/json

{
  "name": "Pavel",
  "surname": "Gaponenko",
  "email": "test@gmail.com"
}
```

2. Запрос на получение пользователя

```http request
GET http://application.local/api/v1/user/4
```

3. Запрос на получение всех пользователей

```http request
GET http://application.local/api/v1/users
```

В ответе на все запросы приходит идентификатор запроса:

```json
{
  "requestId": 67354
}
```

#### Запрос на получение результата

```http request
GET http://application.local/api/v1/result/22
```

В ответе приходит статус обработки запроса:

- 0 - запрос в обработке
- 1 - запрос обработан
- 2 - ошибка обработки запроса

В поле data будет находиться результат выполнения запроса, если запрос был обработан или null, если произошла ошибка или запрос находится в обработке.

## Документация

Документация REST API содержится в файле ```documentation/Swagger.yaml```
