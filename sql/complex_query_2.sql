EXPLAIN SELECT MAX(cost) as max FROM tickets;

-- 10 000 строк
-- +-----------------------------------------------------------------+
-- |QUERY PLAN                                                       |
-- +-----------------------------------------------------------------+
-- |Aggregate  (cost=168.35..168.36 rows=1 width=32)                 |
-- |  ->  Seq Scan on tickets  (cost=0.00..149.48 rows=7548 width=32)|
-- +-----------------------------------------------------------------+

-- 10 000 000 строк
-- +--------------------------------------------------------------------------------------------+
-- |QUERY PLAN                                                                                  |
-- +--------------------------------------------------------------------------------------------+
-- |Finalize Aggregate  (cost=126928.40..126928.41 rows=1 width=32)                             |
-- |  ->  Gather  (cost=126928.19..126928.40 rows=2 width=32)                                   |
-- |        Workers Planned: 2                                                                  |
-- |        ->  Partial Aggregate  (cost=125928.19..125928.20 rows=1 width=32)                  |
-- |              ->  Parallel Seq Scan on tickets  (cost=0.00..115500.95 rows=4170895 width=11)|
-- +--------------------------------------------------------------------------------------------+

-- Оптимизация
CREATE INDEX tickets_cost_index ON tickets(cost);

-- 10 000 000 строк после оптимизации
-- +---------------------------------------------------------------------------------------------------------------------------------+
-- |QUERY PLAN                                                                                                                       |
-- +---------------------------------------------------------------------------------------------------------------------------------+
-- |Result  (cost=0.47..0.48 rows=1 width=32)                                                                                        |
-- |  InitPlan 1 (returns $0)                                                                                                        |
-- |    ->  Limit  (cost=0.43..0.47 rows=1 width=11)                                                                                 |
-- |          ->  Index Only Scan Backward using tickets_cost_session_index on tickets  (cost=0.43..329751.43 rows=10010000 width=11)|
-- |                Index Cond: (cost IS NOT NULL)                                                                                   |
-- +---------------------------------------------------------------------------------------------------------------------------------+
