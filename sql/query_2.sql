-- Запрос
analyse hall;
explain select name from hall where number_of_seats > 990;

-- План при 10 000 строк
-- +-----------------------------------------------------+
-- |QUERY PLAN                                           |
-- +-----------------------------------------------------+
-- |Seq Scan on hall  (cost=0.00..38.00 rows=17 width=11)|
-- |  Filter: (number_of_seats > 990)                    |
-- +-----------------------------------------------------+


-- План при 10 000 000 строк
-- +-------------------------------------------------------------------------+
-- |QUERY PLAN                                                               |
-- +-------------------------------------------------------------------------+
-- |Gather  (cost=1000.00..26304.27 rows=21486 width=11)                     |
-- |  Workers Planned: 2                                                     |
-- |  ->  Parallel Seq Scan on hall  (cost=0.00..23155.67 rows=8952 width=11)|
-- |        Filter: (number_of_seats > 990)                                  |
-- +-------------------------------------------------------------------------+

-- Оптимизации
create index hall_number_of_seats_name_index on hall (number_of_seats, name);
-- делаю индекс по двум полям, т.к. предполагаю, что изменяться таблица hall будет нечасто


-- План при 10 000 000 строк после оптимизаций
-- +------------------------------------------------------------------------------------------------------+
-- |QUERY PLAN                                                                                            |
-- +------------------------------------------------------------------------------------------------------+
-- |Index Only Scan using hall_number_of_seats_name_index on hall  (cost=0.43..708.43 rows=21486 width=11)|
-- |  Index Cond: (number_of_seats > 990)                                                                 |
-- +------------------------------------------------------------------------------------------------------+
